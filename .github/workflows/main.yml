name: Deploy to ECR

on:
 
  push:
    branches: 
    - master
    - main

jobs:
  
  build:
    
    name: Build Image
    runs-on: ubuntu-latest

   
    steps:

    - name: Check out code
      uses: actions/checkout@v2
    
    - name: Log in to Amazon ECR
      run: |
       mkdir -p $HOME/.aws/credentials
       echo "[default]" >> /.aws/credentials
       echo "aws_access_key_id=${{ secrets.AWS_ACCESS_KEY_ID }}" >> ~/.aws/credentials
       echo "aws_secret_access_key=${{ secrets.AWS_SECRET_ACCESS_KEY }}" >> ~/.aws/credentials
       aws configure set default.region us-east-1
       $(aws ecr get-login-password --region us-east-1) | docker login --username AWS --password-stdin 232901375965.dkr.ecr.us-east-1.amazonaws.com

